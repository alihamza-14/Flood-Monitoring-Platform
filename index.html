<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Display a map on a webpage</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.4.0/mapbox-gl.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        #menu { position: absolute; background: white; padding: 10px; font-family: 'Open Sans', sans-serif; }
    </style>
</head>
<body>
<div id="map"></div>
<div id="menu"></div>
<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoibXVzdGkyMSIsImEiOiJjbHE4OG1qdzUxY2hnMmpvY2Vhcnhza2JnIn0.ds7zj-rL6tECEsvopbc_PQ';
    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v11',
        center: [69.3451, 30.3753],
        zoom: 4
    });

    map.on('load', function () {
        map.addSource('Aug', {
            type: 'geojson',
            data: 'http://localhost:8081/geoserver/Danish/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=Danish%3AAugFlood&maxFeatures=50&outputFormat=application%2Fjson'
        });

        map.addLayer({
            id: 'geojsonLayerAug',
            type: 'fill',
            source: 'Aug',
            layout: {},
            paint: {
                'fill-color': '#ff0000',
                'fill-opacity': 0.5
            }
        });

        map.addSource('June', {
            type: 'geojson',
            data: 'http://localhost:8081/geoserver/Danish/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=Danish%3AJuneFlood&maxFeatures=50&outputFormat=application%2Fjson'
        });

        map.addLayer({
            id: 'geojsonLayerJune',
            type: 'fill',
            source: 'June',
            layout: {},
            paint: {
                'fill-color': '#00ff00',
                'fill-opacity': 0.5
            }
        });

        map.addSource('July', {
            type: 'geojson',
            data: 'http://localhost:8081/geoserver/Danish/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=Danish%3AJulyFlood&maxFeatures=50&outputFormat=application%2Fjson'
        });

        map.addLayer({
            id: 'geojsonLayerJuly',
            type: 'fill',
            source: 'July',
            layout: {},
            paint: {
                'fill-color': '#0000ff',
                'fill-opacity': 0.5
            }
        });

        map.addSource('Sep', {
            type: 'geojson',
            data: 'http://localhost:8081/geoserver/Danish/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=Danish%3ASepFlood&maxFeatures=50&outputFormat=application%2Fjson'
        });

        map.addLayer({
            id: 'geojsonLayerSep',
            type: 'fill',
            source: 'Sep',
            layout: {},
            paint: {
                'fill-color': '#ffff00',
                'fill-opacity': 0.5
            }
        });
    });

    var toggleableLayerIds = ['geojsonLayerAug', 'geojsonLayerJune', 'geojsonLayerJuly', 'geojsonLayerSep'];
    for (var i = 0; i < toggleableLayerIds.length; i++) {
        var id = toggleableLayerIds[i];

        var link = document.createElement('a');
        link.href = '#';
        link.className = 'active';
        link.textContent = id;
        
        link.onclick = function (e) {
            var clickedLayer = this.textContent;
            e.preventDefault();
            e.stopPropagation();

            var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

            if (visibility === 'visible') {
                map.setLayoutProperty(clickedLayer, 'visibility', 'none');
                this.className = '';
            } else {
                this.className = 'active';
                map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
            }
        };

        var layers = document.getElementById('menu');
        layers.appendChild(link);
    }
</script>
</body>
</html>
